<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Honeybee biology • SIMplyBee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Honeybee biology">
<meta property="og:description" content="SIMplyBee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMplyBee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-question-circle"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_Honeybee_biology.html">Honeybee Biology</a>
    </li>
    <li>
      <a href="../articles/C_Colony_events.html">Colony Events</a>
    </li>
    <li>
      <a href="../articles/B_Multiple_colonies.html">Multiple colonies</a>
    </li>
    <li>
      <a href="../articles/D_Crossing.html">Crossing</a>
    </li>
    <li>
      <a href="../articles/E_Genomics.html">Genomics</a>
    </li>
    <li>
      <a href="../articles/G_Sampling_functions.html">Sampling functions</a>
    </li>
    <li>
      <a href="../articles/F_Quantitative_Genetics.html">Quantitative Genetics</a>
    </li>
    <li>
      <a href="../articles/Z_FAQs.html">FAQs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HighlanderLab/SIMplyBee/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Honeybee biology</h1>
            
            <h4 data-toc-skip class="date">2022-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HighlanderLab/SIMplyBee/blob/HEAD/vignettes/A_Honeybee_biology.Rmd" class="external-link"><code>vignettes/A_Honeybee_biology.Rmd</code></a></small>
      <div class="hidden name"><code>A_Honeybee_biology.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes and demonstrates how SIMplyBee implements
honeybee biology. Specifically, it describes:</p>
<ol style="list-style-type: decimal">
<li><p>initiating simulation with founder genomes and simulation
parameters,</p></li>
<li><p>creating and building up a colony,</p></li>
<li><p>colony structure, and</p></li>
<li><p>complementary sex determining (<em>CSD</em>) locus.</p></li>
</ol>
<p>First, you need to install the package with
<code>install.packages(pkg = "SIMplyBee")</code>.</p>
<p>Now load the package and dive in! You load the package by
running:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"SIMplyBee"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: AlphaSimR</span></span>
<span><span class="co">#&gt; Loading required package: R6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'SIMplyBee'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     split</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initiating-simulation-with-founder-genomes-and-global-parameters">Initiating simulation with founder genomes and global
parameters<a class="anchor" aria-label="anchor" href="#initiating-simulation-with-founder-genomes-and-global-parameters"></a>
</h2>
<p>Figure 1 visualizes the initiation of the simulation. First, we
simulate some honeybee genomes that represent the founder population.
You can quickly generate random genomes using AlphaSimR’s
<code><a href="https://gaynorr.github.io/AlphaSimR/reference/quickHaplo.html" class="external-link">quickHaplo()</a></code>. These founder genomes are rapidly simulated
by sampling 0s and 1s, and do not include any species-specific
demographic history. This is equivalent to all loci having allele
frequency 0.5 and being in linkage equilibrium. We use this approach
only for demonstrations and testing.</p>
<p>Alternatively, you can more accurately simulate honeybee genomes with
SIMplyBee’s <code>simulateHoneybeeGenomes()</code>. This function
simulates the honeybee genome using MaCS (Chen et al., 2009) for three
subspecies: <em>A. m. ligustica</em>, <em>A. m. carnica</em>, and <em>A.
m. mellifera</em> according to the demographic model described by
Wallberg et al. (2014).</p>
<p>As a first demonstration, we will use <code><a href="https://gaynorr.github.io/AlphaSimR/reference/quickHaplo.html" class="external-link">quickHaplo()</a></code> and
simulate genomes of two founding individuals. In this example, the
genomes will be represented by only three chromosomes and 1,000
segregating sites per chromosome. Honeybees have 16 chromosomes and far
more segregating sites per chromosome, but we want a quick simulation
here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">founderGenomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/quickHaplo.html" class="external-link">quickHaplo</a></span><span class="op">(</span>nInd <span class="op">=</span> <span class="fl">2</span>, nChr <span class="op">=</span> <span class="fl">3</span>, segSites <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, we use <code>simulateHoneybeeGenomes()</code> to
sample genomes of a founder population including 4 <em>A. m.
mellifera</em> (North) individuals and 2 <em>A. m. carnica</em>
individuals. The genomes will be represented by only three chromosomes
and 5 segregating sites per chromosome. These numbers are of course
extremely low because we want a quick examample for demonstrative
reasons. This chunk of code should take a few minutes to run.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">founderGenomes2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateHoneyBeeGenomes.html">simulateHoneyBeeGenomes</a></span><span class="op">(</span>nMelN <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                           nCar <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                           nChr <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                           nSegSites <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, due to the complexity of this function, even using
such small numbers takes a while to run. Simulating a group of founder
genomes with more realistic numbers will therefore require a lot of time
to run. We suggest running this part to an external server and save the
outcome as an RData file, which we can load in our environment and work
with it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">founderGenomes2</span>, file<span class="op">=</span><span class="st">"FounderGenomes2_3chr.RData"</span><span class="op">)</span></span></code></pre></div>
<p>Besides specifying the number of individuals, chromosomes, and
segregating sites, <code>simulateHoneybeeGenomes()</code>, also takes a
number of genomic parameters: effective population size, ploidy, length
of chromosomes in base pairs, genetic length of a chromosome in Morgans,
mutation rate, recombination rate, and time of population splits. The
default values for these numbers follow published references (Wallberg
et al., 2014). While you can change these parameters, we don’t advise
doing this because such demographic models, and their parameters, are
estimated jointly, so we should not be changing them independently. You
can read more about these parameters in the help page:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">simulateHoneybeeGenomes</span></span></code></pre></div>
<p>Now we are ready to setup global simulation parameters using
<code>SimParamBee</code>. <code>SimParamBee</code> builds upon
AlphaSimR’s <code>SimParam</code>, which includes genome and trait
parameters, but also global pedigree and recombination events. We
usually save the output of <code>SimParamBee</code> as the
<code>SP</code> object (we will assume this in all vignettes). Namely,
all SIMplyBee functions will use this object if you don’t directly
specify <code>simParamBee</code> argument. <code>SimParamBee</code>
additionally holds honeybee specific simulation information (Figure
1):</p>
<ul>
<li>default number of workers (<code>SP$nWorkers</code>) and drones
(<code>SP$nDrones</code>) in a full-sized colony; these numbers are used
by functions such as <code>createWorkers/Drones()</code>,
<code>addWorkers/Drones()</code> and <code><a href="../reference/buildUp.html">buildUp()</a></code>;</li>
<li>default number of drones that a virgin queen mates with
(<code>SP$nFathers</code>)</li>
<li>the <em>CSD</em> information: the chromosome of the <em>CSD</em>
(<code>SP$csdChr</code>), the position (<code>SP$csdPos</code>), and the
desired number of <em>CSD</em> alleles in a population
(<code>SP$nCsdAlleles</code>). The number of <em>CSD</em> alleles
determines the length of the <em>CSD</em> locus
(<code>SP$nCsdSites</code>): <code>nCsdAlleles = nCsdSites**2</code>. By
default, the <em>CSD</em> is placed on its real genomic position on
chromosome 3. However, if the user simulates less than three
chromosomes, the <em>CSD</em> is placed on chromosome 1;</li>
<li>pedigree for each individual created in the simulation
(<code>SP$pedigree</code>) if requested by
<code>SP$setTrackPed(TRUE)</code>; and</li>
<li>caste information for each individual created in the simulation
(<code>SP$caste</code>).</li>
</ul>
<p>You can read more about the <code>SimParam</code> and
<code>SimParamBee</code> in their help pages
(<code><a href="https://gaynorr.github.io/AlphaSimR/reference/SimParam.html" class="external-link">help(SimParam)</a></code> and <code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code>).</p>
<p>Below we use set the number of <em>CSD</em> alleles and default
number of workers and drones in a colony:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SP</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimParamBee.html">SimParamBee</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">founderGenomes</span>, nCsdAlleles <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></span>
<span><span class="va">SP</span><span class="op">$</span><span class="va">nWorkers</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">SP</span><span class="op">$</span><span class="va">nDrones</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<p>After creating the <code>SimParamBee</code> object, you can inspect
it! This returns a lot of output and we suggest you return back to this
point once you are comfortable with the basic functionality!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">SP</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="../reference/figures/founderpop.png" alt="Simulation initiation." width="100%"><p class="caption">
Simulation initiation.
</p>
</div>
<p>From the simulated founder genomes, we can create virgin queens
(Figure 1). These will serve as our our first honeybee individuals (the
so called base or founder population). In AlphaSimR and SIMplyBee,
individuals are stored in <code>Pop</code> class objects, that hold a
group of individuals with their individual identification, parent
identifications, as well as genomes and trait values. So, the
<code>basePop</code> is a population (<code>Pop</code> class object) of
two individuals, our two virgin queens. If we print out
<code>basePop</code>, we see some basic information about the
population: the ploidy, number of individuals, chromosome, loci, and
traits. We next check whether our individuals are of certain caste with
<code>is*()</code> functions, where <code>*</code> can be either
<code>queen</code>, <code>worker</code>, <code>drone</code>,
<code>virginQueen</code>, or <code>father</code>. These functions return
<code>TRUE</code> if the individual is a member of the caste in question
and <code>FALSE</code> is it is not. These functions check the caste
information in the <code>SP$caste</code>. Here, we use
<code><a href="../reference/isCaste.html">isVirginQueen()</a></code> to check whether our base population
individuals are virgin queens.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseQueens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createVirginQueens</a></span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span><span class="va">baseQueens</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 2 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span>
<span><span class="fu"><a href="../reference/isCaste.html">isVirginQueen</a></span><span class="op">(</span><span class="va">baseQueens</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE</span></span></code></pre></div>
<p>Similarly, you can use the function <code><a href="../reference/getCaste.html">getCaste()</a></code> to get
the caste of each individual.</p>
<p>We will use the first virgin queen to create five drones for future
mating. Note that virgin queens do not create drones. Only queens with
colonies create drones. However, to get the simulation up and running,
we need drones and the function <code><a href="../reference/createCastePop.html">createDrones()</a></code> can work
both with virgin queens or colonies (we will present colonies in the
next section). You can use more than one virgin queen to create the
drones or even an entire drone congregation area (DCA) with as many
drones per virgin queen as you want (<code>nInd</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseDrones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createDrones</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">baseQueens</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, nInd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">baseDrones</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 15 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-and-building-up-a-colony">Creating and building up a colony<a class="anchor" aria-label="anchor" href="#creating-and-building-up-a-colony"></a>
</h2>
<p>We will use the other virgin queen to create a colony. You can use
more than one virgin queen to create more than one colony. In SIMplyBee,
a honeybee colony is stored in an object of <code>Colony</code> class.
You can create a new colony with the function
<code><a href="../reference/createColony.html">createColony()</a></code>. You can create a completely empty colony or
a colony with either a virgin or a mated queen. The <code>Colony</code>
class organises all its members in five castes: <code>queen</code>,
<code>fathers</code>, <code>workers</code>, <code>drones</code>, and
<code>virginQueens</code>. We describe the castes in next section. The
<code>Colony</code> further contains technical information about the
colony, its identification <code>id</code> and <code>location</code>
coordinates coded as (<code>latitude</code>, <code>longitude</code>).
Further, it contains logical information about the past colony events:
<code>split</code>, <code>swarm</code>, <code>supersedure</code>, or
<code>collapse</code>. It also contains <code>production</code> status,
which indicates whether we can collect a production phenotype from the
colony. The latter is possible when the colony is built-up to its full
size and has not swarmed. The production is turned off when a colony
downsizes, collapses, or swarms, and for the split of a split colony.
You will learn about these colony events in the Colony events
vignette.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">baseQueens</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: NA </span></span>
<span><span class="co">#&gt; Number of fathers: 0 </span></span>
<span><span class="co">#&gt; Number of workers: 0 </span></span>
<span><span class="co">#&gt; Number of drones: 0 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 1 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: FALSE</span></span></code></pre></div>
<p>We see all the above mentioned information in the printout of the
<code>Colony</code> object. For this specific colony, we see that the ID
of the colony is “8”, the location is not set, and there is no queen
(hence <code>NA</code>). There are consequently no fathers in the
colony, nor any workers, drones or virgin queens. All the events are set
to <code>FALSE</code> (you will learn more about events in the Colony
events vignette) and the colony is not productive, since it does not
include any individuals.</p>
<p>Let’s now mate our virgin queen, so that she is promoted to a queen
and can start laying eggs of her own workers and drones.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">colony</span>, drones <span class="op">=</span> <span class="va">baseDrones</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 2 </span></span>
<span><span class="co">#&gt; Number of fathers: 15 </span></span>
<span><span class="co">#&gt; Number of workers: 0 </span></span>
<span><span class="co">#&gt; Number of drones: 0 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: FALSE</span></span></code></pre></div>
<p>We see that the virgin queen is now a queen - hence we have a queen
with the ID “2” and no virgin queens in our colony.</p>
<p>Next, let’s build up our colony using the function
<code><a href="../reference/buildUp.html">buildUp()</a></code> that adds in workers and drones. This function
takes parameters <code>nWorkers</code> and <code>nDrones</code>, where
we specify how many workers and drones to add. However, if these numbers
are not specified in the function’s call, the function uses the default
numbers from the <code>SimParamBee</code> object
(<code>SP$nWorkers</code> and <code>SP$nDrones</code>). This function
also always turns the <code>production</code> status to
<code>TRUE</code>, since it assumes we are building the colony up to its
full-size.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">colony</span>, nWorkers <span class="op">=</span> <span class="fl">10</span>, nDrones <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 2 </span></span>
<span><span class="co">#&gt; Number of fathers: 15 </span></span>
<span><span class="co">#&gt; Number of workers: 8 </span></span>
<span><span class="co">#&gt; Number of drones: 7 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: TRUE</span></span>
<span><span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 2 </span></span>
<span><span class="co">#&gt; Number of fathers: 15 </span></span>
<span><span class="co">#&gt; Number of workers: 85 </span></span>
<span><span class="co">#&gt; Number of drones: 10 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: TRUE</span></span></code></pre></div>
<p>All the functions in SIMplyBee return objects, hence we need to save
them as an object, otherwise they are lost.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 2 </span></span>
<span><span class="co">#&gt; Number of fathers: 15 </span></span>
<span><span class="co">#&gt; Number of workers: 83 </span></span>
<span><span class="co">#&gt; Number of drones: 10 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="colony-structure">Colony structure<a class="anchor" aria-label="anchor" href="#colony-structure"></a>
</h2>
<p>Lets explore our colony. In every colony we have different groups of
individuals (castes). These include: queen, fathers, workers, drones,
and virgin queens. The queen controls the colony, workers do all the
hard work, drones disseminate queen’s genes, and one of the virgin
queens will eventually replace the queen. We also store fathers, which
represent drones that the queen mated with. The fathers caste is
effectively the drone sperm stored in queen’s spermatheca. Storing
fathers enables us to generate colony members on demand. SIMplyBee
contains <code>n*()</code> functions to count the number of individuals
in each caste, where <code>*</code> is <code>queen</code>,
<code>fathers</code>, <code>workers</code>, <code>drones</code>, and
<code>virginQueens</code>. Let’s count how many individuals we have for
each caste in our colony.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nWorkers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 83</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nDrones</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nVirginQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Next, we can access the individuals of each caste with
<code>get*()</code> functions. These functions leave the colony and its
members intact (they do not change the colony) by copying the
individuals.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getQueen</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 1 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fathers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getFathers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 15 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getWorkers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 83 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">drones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getDrones</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 10 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">virginQueens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getVirginQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>As you see above, there are no virgin queens present in the colony at
this moment, since the queen is active. Future colony events might
change this.</p>
<p>Should you want to pull out, that is, remove castes or their members,
have a look at <code>pull*()</code> functions. These functions return a
list of objects: <code>pulled</code> being the pulled individuals
(<code>Pop</code> object), and <code>remnant</code> being the remaining
colony without the pulled individuals.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullCastePop.html">pullWorkers</a></span><span class="op">(</span><span class="va">colony</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">remnant</span></span>
<span><span class="va">colony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 1 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 2 </span></span>
<span><span class="co">#&gt; Number of fathers: 15 </span></span>
<span><span class="co">#&gt; Number of workers: 73 </span></span>
<span><span class="co">#&gt; Number of drones: 10 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pulledWorkers</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">pulled</span></span>
<span><span class="va">pulledWorkers</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 10 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<p>Next, you can obtain the caste of each individual with the
<code><a href="../reference/getCaste.html">getCaste()</a></code> function. As already mentioned above, a similar
group of functions are the <code>is*()</code> functions that check
whether an individual is of specific caste. Let’s now obtain the caste
of colony members:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">queen</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "queen"</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">fathers</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "fathers" "fathers" "fathers" "fathers" "fathers" "fathers" "fathers"</span></span>
<span><span class="co">#&gt;  [8] "fathers" "fathers" "fathers" "fathers" "fathers" "fathers" "fathers"</span></span>
<span><span class="co">#&gt; [15] "fathers"</span></span></code></pre></div>
<p>and so on. When you have a collection of bees at hand and you might
not know their source, the <code><a href="../reference/getCaste.html">getCaste()</a></code> can be very
useful:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">queen</span>, <span class="va">fathers</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">workers</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">drones</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">bees</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "queen"   "fathers" "fathers" "workers" "workers" "drones"  "drones"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="complementary-sex-determining-locus">Complementary sex determining locus<a class="anchor" aria-label="anchor" href="#complementary-sex-determining-locus"></a>
</h2>
<p>The complementary sex determiner (<em>CSD</em>) locus, well,
complements sex determination. Fertilised eggs that are heterozygous at
the <em>CSD</em> locus develop into workers. On the other hand,
homozygous eggs develop into unviable drones. These drones are usually
discarded by workers. SIMplyBee does not store these unviable drones,
but it does store their number in the queen’s miscellaneous slot
(<code>queen@misc</code>). Here, you can find the total number of
workers and drones produced by the queen (<code>nWorkers</code> and
<code>nDrones</code>) and how many of the diploid offspring were
homozygous at the <em>CSD</em> (<code>nHomBrood</code>). There is also a
<code>pHomBrood</code> slot, that represents the theoretical (expected)
proportion of offspring that are expected to be homozygous based on
queen’s and father’s <em>CSD</em> alleles. You can obtain
<code>pHomBrood</code> and <code>nHomBrood</code> values with the
corresponding <code><a href="../reference/calcQueensPHomBrood.html">pHomBrood()</a></code> and <code>nHombrood()</code>
functions that can be applied either on the queen (<code>Pop</code>
class) or colony (<code>Colony</code> class) directly. You can obtain
the entire <code>misc</code> slot with the <code><a href="https://gaynorr.github.io/AlphaSimR/reference/getMisc.html" class="external-link">getMisc()</a></code>
function.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/getMisc.html" class="external-link">getMisc</a></span><span class="op">(</span><span class="fu"><a href="../reference/getCastePop.html">getQueen</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$fathers</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 15 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nWorkers</span></span>
<span><span class="co">#&gt; [1] 83</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nDrones</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nHomBrood</span></span>
<span><span class="co">#&gt; [1] 17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$pHomBrood</span></span>
<span><span class="co">#&gt; [1] 0.1666667</span></span></code></pre></div>
<p>Technically, in SIMplyBee we represent the <em>CSD</em> locus as a
series of bi-allelic single nucleotide polymorphisms that don’t
recombine. So, the <em>CSD</em> locus is represented as a
non-recombining haplotype and different haplotypes represent different
<em>CSD</em> alleles. By varying the number of sites within the
<em>CSD</em> locus we can control the number of distinct alleles (see
<code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code>).</p>
<p>We can retrieve information about <em>CSD</em> alleles with
<code><a href="../reference/getCsdAlleles.html">getCsdAlleles()</a></code>. For details on where the <em>CSD</em>
locus is and the number of distinct alleles, see
<code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code>. Looking at the below output, the first
row shows marker identifications (chromosome_locus) and the first column
shows haplotype identifications (individual_haplotype). The alleles are
represented with a sequence of 0’s and 1’s. You can see that the two
sequences are different, meaning that the queen is heterozygous, as
expected.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">queen</span><span class="op">)</span></span>
<span><span class="co">#&gt;     3_86 3_87 3_88 3_89 3_90</span></span>
<span><span class="co">#&gt; 2_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 2_2    1    1    0    0    1</span></span></code></pre></div>
<p>A keen geneticist would immediately inspect <em>CSD</em> alleles of
fathers to check for any similarity with the queen’s <em>CSD</em>
alleles. Let’s boost a chance of such an event by creating an inbreed
colony. We will create a virgin queen from the current colony and mate
her with her brothers. Oh, dear.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/createCastePop.html">createVirginQueens</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colony</span>, nInd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fathers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/selectInd.html" class="external-link">selectInd</a></span><span class="op">(</span><span class="va">drones</span>, nInd <span class="op">=</span> <span class="va">SP</span><span class="op">$</span><span class="va">nFathers</span>, use <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in selectInd(drones, nInd = SP$nFathers, use = "rand"): Suitable</span></span>
<span><span class="co">#&gt; candidates smaller than nInd, returning 10 individuals</span></span>
<span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">inbredColony</span>, drones <span class="op">=</span> <span class="va">fathers</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co">#&gt; $queen</span></span>
<span><span class="co">#&gt;       3_86 3_87 3_88 3_89 3_90</span></span>
<span><span class="co">#&gt; 255_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 255_2    0    1    1    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fathers</span></span>
<span><span class="co">#&gt;       3_86 3_87 3_88 3_89 3_90</span></span>
<span><span class="co">#&gt; 245_1    1    1    0    0    1</span></span>
<span><span class="co">#&gt; 251_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 254_1    1    1    0    0    1</span></span>
<span><span class="co">#&gt; 247_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 250_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 253_1    1    1    0    0    1</span></span>
<span><span class="co">#&gt; 249_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 252_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 246_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 248_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $workers</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $drones</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $virginQueens</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">inbredColony</span>, unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $queen</span></span>
<span><span class="co">#&gt;       3_86 3_87 3_88 3_89 3_90</span></span>
<span><span class="co">#&gt; 255_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 255_2    0    1    1    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fathers</span></span>
<span><span class="co">#&gt;       3_86 3_87 3_88 3_89 3_90</span></span>
<span><span class="co">#&gt; 249_1    0    0    1    0    1</span></span>
<span><span class="co">#&gt; 254_1    1    1    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $workers</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $drones</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $virginQueens</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Can you spot any matches? Let’s calculate the expected proportion of
homozygous brood from this mating.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">pHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.35</span></span></code></pre></div>
<p>Let’s see how many homozygotes will we observe. Note that inheritance
is a random process, so a realised number of homozygotes will deviate
from the expected proportion.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addCastePop.html">addWorkers</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">inbredColony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 2 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 255 </span></span>
<span><span class="co">#&gt; Number of fathers: 10 </span></span>
<span><span class="co">#&gt; Number of workers: 66 </span></span>
<span><span class="co">#&gt; Number of drones: 0 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: FALSE</span></span>
<span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">nHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34</span></span></code></pre></div>
<p>We tried adding 100 workers, but we only got 66. The difference of 34
is due to <em>CSD</em> homozygous brood. Let’s add another set of
workers to show variation in the realised numbers and accumulation of
information.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addCastePop.html">addWorkers</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">inbredColony</span></span>
<span><span class="co">#&gt; An object of class "Colony" </span></span>
<span><span class="co">#&gt; Id: 2 </span></span>
<span><span class="co">#&gt; Location: </span></span>
<span><span class="co">#&gt; Queen: 255 </span></span>
<span><span class="co">#&gt; Number of fathers: 10 </span></span>
<span><span class="co">#&gt; Number of workers: 140 </span></span>
<span><span class="co">#&gt; Number of drones: 0 </span></span>
<span><span class="co">#&gt; Number of virgin queens: 0 </span></span>
<span><span class="co">#&gt; Has split: FALSE </span></span>
<span><span class="co">#&gt; Has swarmed: FALSE </span></span>
<span><span class="co">#&gt; Has superseded: FALSE </span></span>
<span><span class="co">#&gt; Has collapsed: FALSE </span></span>
<span><span class="co">#&gt; Is productive: FALSE</span></span>
<span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">nHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 60</span></span></code></pre></div>
<p>In total we tried adding 200 workers. We got 140 workers and 60
homozygous brood. To see all this information, we can inspect the
miscellaneous slot of the queen that contains the fathers population as
well as the cumulative number of workers, drones, homozygous brood, and
the expected proportion of homozygous brood.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/getMisc.html" class="external-link">getMisc</a></span><span class="op">(</span><span class="fu"><a href="../reference/getCastePop.html">getQueen</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$fathers</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 10 </span></span>
<span><span class="co">#&gt; Chromosomes: 3 </span></span>
<span><span class="co">#&gt; Loci: 300 </span></span>
<span><span class="co">#&gt; Traits: 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nWorkers</span></span>
<span><span class="co">#&gt; [1] 140</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nDrones</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$nHomBrood</span></span>
<span><span class="co">#&gt; [1] 60</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$pHomBrood</span></span>
<span><span class="co">#&gt; [1] 0.35</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Chen G.K., Marjoram P., Wall J.D. (2009) Fast and flexible simulation
of DNA sequence data. Genome Research, 19(1):136–142. <a href="https://doi.org/10.1101/gr.083634.108" class="external-link uri">https://doi.org/10.1101/gr.083634.108</a></p>
<p>Wallberg, A., Han, F., Wellhagen, G. et al. (2014) A worldwide survey
of genome sequence variation provides insight into the evolutionary
history of the honeybee Apis mellifera. Nature Genetics, 46:1081–1088.
<a href="https://doi.org/10.1038/ng.3077" class="external-link uri">https://doi.org/10.1038/ng.3077</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jana Obšteter, Laura Strachan, Jernej Bubnič, Gregor Gorjanc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
