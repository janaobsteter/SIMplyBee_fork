<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sampling functions • SIMplyBee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sampling functions">
<meta property="og:description" content="SIMplyBee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMplyBee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-question-circle"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_Honeybee_biology.html">Honeybee Biology</a>
    </li>
    <li>
      <a href="../articles/2_Colony_events.html">Colony Events</a>
    </li>
    <li>
      <a href="../articles/3_Multiple_colonies.html">Multiple colonies</a>
    </li>
    <li>
      <a href="../articles/4_Genomics.html">Genomics</a>
    </li>
    <li>
      <a href="../articles/5_Sampling_functions.html">Sampling functions</a>
    </li>
    <li>
      <a href="../articles/6_Quantitative_Genetics.html">Quantitative Genetics</a>
    </li>
    <li>
      <a href="../articles/7_FAQs.html">FAQs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HighlanderLab/SIMplyBee/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sampling functions</h1>
            
            <h4 data-toc-skip class="date">2022-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HighlanderLab/SIMplyBee/blob/HEAD/vignettes/G_Sampling_functions.Rmd" class="external-link"><code>vignettes/G_Sampling_functions.Rmd</code></a></small>
      <div class="hidden name"><code>G_Sampling_functions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>SIMplyBee includes functions to sample various values that are
expected to vary between colonies and events. These functions are used
to sample numbers, usually individuals, and proportions. We can use the
functions, pass them to other functions, or save them in the
<code>SimParamBee</code> object so they can be used by default by other
functions.</p>
<p>We start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"SIMplyBee"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: AlphaSimR</span></span>
<span><span class="co">#&gt; Loading required package: R6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'SIMplyBee'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     split</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="functions-to-sample-numbers">Functions to sample numbers<a class="anchor" aria-label="anchor" href="#functions-to-sample-numbers"></a>
</h2>
<p>First, there are functions to sample the number of caste individuals
from either a Poisson or truncated Poisson distribution:
<code>n*Poisson()</code> and <code>n*TruncPoisson()</code>, where
<code>*</code> is either <code>Workers</code>, <code>Drones</code>,
<code>VirginQueens</code>, or <code>Fathers</code>. Most SIMplyBee
functions that take the number of individuals as an argument can accept
these sampling functions as an input, meaning that the output of such
function calls will be stochastic. These functions are useful when you
want to sample a variable number of individuals around a mean, as for
example when mating virgin queens with a variable number of drones.</p>
<p>Let’s start a simulation by creating a DCA and an apiary with 10
virgin colonies:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">founderGenomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/quickHaplo.html" class="external-link">quickHaplo</a></span><span class="op">(</span>nInd <span class="op">=</span> <span class="fl">20</span>, nChr <span class="op">=</span> <span class="fl">1</span>, segSites <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">SP</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimParamBee.html">SimParamBee</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span><span class="va">basePop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createVirginQueens</a></span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a DCA from the first 10 base virgin queens</span></span>
<span><span class="va">DCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createDrones</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, nInd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an apiary with 10 virgin colonies</span></span>
<span><span class="va">apiary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMultiColony.html">createMultiColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>From the literature we know that virgin queens on average mate to 17
drones, but the actual number varies around this mean. Some mate with 10
drones, some with 20, etc. To resemble this variation, we can use the
function <code><a href="../reference/nFathersFun.html">nFathersPoisson()</a></code> to sample variable number of
drones from a DCA. The default average for this function is 15, but you
can use any value you want. Let’s use this function to sample 1,000
values and inspect the distribution and the mean.</p>
<p><img src="G_Sampling_functions_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>Let’s now use this functionality to sample a variable number of
drones from the DCA to mate with each of the 10 virgin queens.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">droneGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullDroneGroupsFromDCA.html">pullDroneGroupsFromDCA</a></span><span class="op">(</span>DCA <span class="op">=</span> <span class="va">DCA</span>, n <span class="op">=</span> <span class="fl">10</span>, nDrones <span class="op">=</span> <span class="va">nFathersPoisson</span><span class="op">)</span></span>
<span><span class="va">apiary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">apiary</span>, drones <span class="op">=</span> <span class="va">droneGroups</span><span class="op">)</span></span></code></pre></div>
<p>And inspect the number of fathers in each of the colony and their
mean.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary</span><span class="op">)</span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span></span>
<span><span class="co">#&gt; 21 11 25 13 11 17 15 20 13 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15.7</span></span></code></pre></div>
<p>Second, we have a group of functions that will sample the number of
individuals according to the colony phenotype, whatever that might be.
These functions are named <code>n*ColonyPhenotype()</code>, where
<code>*</code> is either is either <code>Workers</code>,
<code>Drones</code>, or <code>VirginQueens</code>. An example of this
would be sampling the number of workers and drones according to queen’s
fecundity or honey yield. An example of this can be seen in the
quantitative genetics vignette in the “Strength and honey yield”
example.</p>
</div>
<div class="section level2">
<h2 id="functions-that-sample-proportions">Functions that sample proportions<a class="anchor" aria-label="anchor" href="#functions-that-sample-proportions"></a>
</h2>
<p>SIMplyBee also includes functions to sample the proportions of
workers that leave or are removed when downsizing, splitting, or
swarming a colony from either a uniform distribution or from a beta
distribution that accounts for the number of individuals in a colony
(colony strength). These functions are named <code>*PUnif()</code>,
where <code>*</code> can be either <code>swarm</code>,
<code>split</code>, or <code>downsize</code>. There is an additional
function, <code><a href="../reference/splitPFun.html">splitPColonyStrength()</a></code>, that determines the
number of workers to be removed in a split according to the colony
strength.</p>
<p>Let’s say we want to swarm all the colonies in our apiary with a
variable percentage of workers that leave. We want to sample this
percentage from an uniform distribution with the mean of 0.6. For this,
we use <code><a href="../reference/swarmPFun.html">swarmPUnif()</a></code> function that takes a <code>min</code>
and a <code>max</code> values and sample a value between them. By
default, the <code>min</code> is set to 0.4 and <code>max</code> to 0.6.
Let’s use this function to sample a 1,000 values between 0.5 and 0.7 and
inspect the mean.</p>
<p><img src="G_Sampling_functions_files/figure-html/unnamed-chunk-6-1.png" width="288"></p>
<p>Let’s now swarm all the colonies in our apiary with a variable
percentage of workers that leave.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apiary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">apiary</span>, nWorkers <span class="op">=</span> <span class="fl">1000</span>, nDrones <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/swarm.html">swarm</a></span><span class="op">(</span><span class="va">apiary</span>, p <span class="op">=</span> <span class="fu"><a href="../reference/swarmPFun.html">swarmPUnif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nWorkers</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">swarm</span><span class="op">)</span></span>
<span><span class="co">#&gt;  11  13  15  17  19  21  23  25  27  29 </span></span>
<span><span class="co">#&gt; 579 623 542 511 521 514 547 604 618 536</span></span></code></pre></div>
<p>We see that each colony swarmed with a different percentage between
0.5 and 0.7.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jana Obšteter, Laura Strachan, Jernej Bubnič, Gregor Gorjanc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
